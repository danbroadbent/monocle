<h1><%= @company.name %></h1>
<h3>Company Information</h3>
<table class="table-condensed table-hover">
  <tr>
    <th>Products/Services:</th>
    <td><%= @company.products_services %></td>
  </tr>
  <tr>
    <th>Website:</th>
    <td><%= @company.website %></td>
  </tr>
  <tr>
    <th>Headquarters:</th>
    <td><%= @company.headquarters %></td>
  </tr>
</table>
<h3><%= pluralize(@company.locations.count, 'Location') %></h3>
<table class="table-condensed table-hover">
  <tr>
    <th>Address:</th>
  </tr>
  <tr>
    <th>Phone:</th>
  </tr>
  <tr>
    <th>Primary Contact:</th>
  </tr>
  <% @company.locations.each do |location | %>
    <tr>
      <td><%= location.street_address %><br>
        <%= location.street_address_2 %> <br>
        <%= location.city_state_zip %>
      </td>
    </tr>
    <tr>
      <td><%= location.phone %></td>
    </tr>
    <tr>
      <td><%= location.primary_contact %></td>
    </tr>
  <% end %>
</table>

<% if current_user.companies.exists?(@company.id) %>
  <h4><i class="text-info">
    <span class="glyphicon glyphicon-star" aria-hidden="true"></span> This company has been saved in your starred list.
  </i></h4>
<% else %>
  <%= button_tag class: "btn btn-default btn-lg", id: "star", data: {id: @company.id} do %>
    <%= content_tag("span", "", class: ["glyphicon", "glyphicon-star"], aria_hidden: true) %> Star
  <% end %>
<% end %>

<% if current_user.admin? %>
  <h4>Administrator Tools</h4>
  <ul>
    <li><%= link_to 'Edit Information', edit_admin_company_path(@company) %></li>
  </ul>
<% end %>

<h3>Notes</h3>
<div id='notes' class='panel-group'>
<% @company.notes.each do |note| %>
  <div class='note-block panel panel-default'>
    <div class='panel-body small'>
    <% if current_user.id == note.user_id || current_user.admin? %>
      <div class='btn-group pull-right'>
        <a href="/companies/<%= @company.id %>/notes/<%= note.id %>/edit" class="edit-button btn btn-default btn-sm"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span></a>
        <a href="/companies/notes/delete?company_id=<%= @company.id %>&note_id=<%= note.id %>" class="delete-button btn btn-default btn-sm"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a>
      </div>
      <% end %>
        <div class='pull-left'>
          <h6>Author:
            <%= note.user.username %>
          </h6>
          <h6>
            <%= note.title %>
          </h6>
          <p>
            <%= note.body %>
          </p>
        </div>
      </div>
    </div>
  </div>
<% end %>

<div class='panel panel-default'>
  <div class='panel-body'>
    <%= form_for [@company, @company.notes.build] do |f| %>
      <div class='form-group text-left'>
        <%= f.text_field 'title', placeholder: 'Title' %>
      </div>
      <div class='form-group text-left'>
        <%= f.text_area 'body', placeholder: 'Note' %>
      </div>
      <div class='btn-group'>
        <%= f.submit 'Add Note' %>
      </div>
    <% end %>
  </div>
</div>
</div>
